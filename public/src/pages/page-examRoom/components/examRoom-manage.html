
<link rel="import" href="./student-list.html">
<link rel="import" href="./manage-list.html">

<dom-module id="examRoom-manage">
    <template>
        <style include="page-style flex-style">
            .margin{
                margin-top: 16px;
                text-align: center;
            }
        </style>
        <div class="container">
            
            <paper-material elevation="1">
                <div class="container bgWhite">
                    <div class="flex-horizontal-with-ratios">
                        <div class="flexchild"></div>
                        <div class="flexchild fontCSC margin">
                            ชื่อห้องสอบ
                        </div>
                        <div class="flex3child" style="text-align: left">
                            <gl-form-input class"width" no-label-float></gl-form-input>
                        </div>
                        <div class="flexchild"></div>
                    </div>
                    <div class="flex-horizontal-with-ratios">
                        <div class="flexchild"></div>
                        <div class="flexchild fontCSC margin">
                            เลือกข้อสอบ
                        </div>
                        <div class="flex3child" style="text-align: left">
                            <gl-combo-box class"width" no-label-float items="[[examList]]" item-label-path="ex_name" item-value-path="id" value=""></gl-combo-box>
                        </div>
                        <div class="flexchild"></div>
                    </div>
                    <div class="flex-horizontal-with-ratios">
                        <div class="flexchild"></div>
                        <div class="flexchild fontCSC margin">
                            กำหนดเวลา
                        </div>
                        <div class="flexchild" style="text-align: left">
                            <gl-form-input class"width" type="number" no-label-float>
                                <div suffix>นาที</div>
                            </gl-form-input>
                        </div>
                        <div class="flex3child"></div>
                    </div>
                </div>
            </paper-material>
            <div class="flex-equal-around-justified">
                <div>
                    <student-list data="[[studentList]]" icon="clear" active="cancel"></student-list>
                    <!--<manage-list></manage-list>-->
                </div>
                <div>
                    <student-list data="[[studentList]]" icon="add" active="join"></student-list>
                    <!--<manage-list></manage-list>-->
                </div>
            </div>
        </div>
        <div class="container flex-end-justified">
            <div>
                <paper-button class="gl-btn-danger" raised>ยกเลิก</paper-button>
            </div>
            <div>
                <paper-button class="gl-btn-success" raised>บันทึก</paper-button>
            </div>
        </div>
    </template>
    <script>
        Polymer({
            is: 'examRoom-manage',
            observers:['getExamList(user.id)'],
            listeners:{
                'join-student':'joinStudent',
                'cancel-student':'cancelStudent'
            },
            behaviors: [ReduxBehavior,dispatchActionBehavior],
            properties:{
                user:{
                    statePath:'auth.user'
                },
                examList:{
                    statePath:'examRoom.examList'
                },
                studentList:{
                    statePath:'examRoom.studentList',
                    observer:'setStudentList'
                },
            },
            ready:function(){
                this.dispatchAction('EXAMROOM_GET_STUDENT_LIST');
            },
            getExamList:function(id){
                this.dispatchAction('EXAMROOM_GET_EXAM_LIST',this.user.id);
                console.log(this.examList);
            },
            setStudentList:function(){
                this.studentList.map((item)=>{
                    return item.check = true;
                })
            },
            // fillterStudent:function(){
            //     this.joinStundent = this.studentList.filter((item)=>{
            //         return item.check == true;
            //     })
            //     this.cancelStudnet = this.studentList.filter((item)=>{
            //         return item.check == false;
            //     })
            // },
            joinStudent:function(e){
                this.set('studentList.'+e.detail+'.check',false);
            },
            cancelStudent:function(e){
                this.set('studentList.'+e.detail+'.check',true);
                // this.set('cancelStudnet.'+e.detail+'.check',true);
                // this.fillterStudent();
            }
        });
    </script>
</dom-module>