
<link rel="import" href="./components/test-list.html">

<dom-module id="page-test">
    <template>
        <style include="page-style"></style>
        <div class="container">
            <div class="header gl-large">แบบทดสอบ</div>
            <paper-material elevation="1">
                 <table class="gl-table-default">
                    <thead>
                        <tr class="hideBorder">
                            <th style="width:20%;text-align: right; font-size: 18px;">ชื่อข้อสอบ</th>
                            <th><gl-form-input placeholder="" no-label-float value="แบบทดสอบก่อนเรียน" disabled></gl-form-input></th>
                            <th></th>
                        </tr>
                        <tr>
                            <th style="width:20%;text-align: right; font-size: 18px;">คำอธิบาย</th>
                            <th><gl-form-textarea placeholder="" no-label-float value="ข้อสอบมีทั้งหมด [[dataList.question.length]] ข้อ" disabled></gl-form-textarea></th>
                             <th></th>
                        </tr>
                    </thead>
                    <template is="dom-if" if={{!stat}}>
                    <tbody>
                        <tr>
                            <td colspan="3">ไม่พบข้อมูล</td>
                        </tr>
                    </tbody>
                     </template>
                 </table>
            </paper-material>
            
            <template is="dom-if" if="{{stat}}">
                <template is="dom-repeat" items="[[dataList.question]]">
                    <test-list data="[[item]]" index="[[cont(index)]]"></test-list>
                   
                </template>
            </template>
            
        </div>
         <paper-fab icon="icons:send" title="ส่งข้อสอบ" on-tap="confirmToast"></paper-fab>
    </template>
    <script>
        Polymer({
            is: 'page-test',
            behaviors:[ReduxBehavior,examinationAction],
            observers:['getTest(exId)'],
            properties:{
                 dataList:{
                    statePath:'examination.dataTest'
                },
                // dataList:{
                //     type:Array,
                //     value:[
                //         {
                //             topic:'1+1',
                //             choice:[
                //                 {
                //                     choice: '1',
                //                     checked: false
                //                 },
                //                  {
                //                     choice: '2',
                //                     checked: false
                //                 },
                //                  {
                //                     choice: '3',
                //                     checked: false
                //                 },
                //                  {
                //                     choice: '4',
                //                     checked: false
                //                 },
                //             ]
                //         }
                //     ]
                // }
            },
            getTest:function(id){
                this.stat = true;
                this.EXAMINATION_GET_DATA_TEST(id);
            },
            cont:function(index){
                return index+1;
            },
            confirmToast:function(){
                this.fire('toast',{ 
                 status:'openDialog',
                 text:'ต้องการส่งแบบทดสอบใช่หรือไม่ ?',
                 confirmed:this.openToast.bind(this), 
                 })
            },
            openToast:function(check){
                if(check==true){
                    this.fire('toast',{status:'load'});
                    this.async(function(){
                        this.fire('toast',{status:'success',text:'บันทึกสำเร็จ',
                        callback:function(){
                        }
                        });
                        this.stat = false;
                    }.bind(this),500);
                }
            }

        });
    </script>
</dom-module>